version: v1
name: "nova-app"
target: "nova-app:latest"

sources:
  # Build first: `make build-docker`
  app: "nova-app-template:latest"

# Odyn Primary API (full functionality)
api:
  listen_port: 18000

# Odyn Auxiliary API (restricted, for sidecars)
aux_api:
  listen_port: 18001

# Application ingress - listen_port must match the "App Listening Port" 
# specified when creating the app on the Nova platform.
ingress:
  - listen_port: 8000
  - listen_port: 18001

# Egress for external API calls
# NOTE: Nova platform manages this automatically for you.
egress:
  allow:
    - "**"           # All domains
    - "0.0.0.0/0"    # All IPv4
    - "::/0"         # All IPv6

# Nova KMS + App Wallet integration
# NOTE: `kms_app_id` + `nova_app_registry` enables registry-backed /v1/kms/*.
# NOTE: `use_app_wallet=true` enables /v1/app-wallet/*.
kms_integration:
  enabled: true
  use_app_wallet: true
  kms_app_id: 1001
  nova_app_registry: "0x0f68E6e699f2E972998a1EcC000c7ce103E64cc8"

# S3 persistent storage
# NOTE: Nova platform provisions and manages these values during deployment.
storage:
  s3:
    enabled: true
    bucket: "your-bucket-name"
    prefix: "apps/your-app-id/"
    region: "us-east-1"
    encryption:
      mode: "kms"
      key_scope: "object"
      aad_mode: "key"
      key_version: "v1"
      accept_plaintext: true

# Helios trustless multi-chain RPC
# - 18545 is reserved for auth-chain registry discovery when KMS registry mode is enabled.
# - 18546 is used by app business logic (default).
helios_rpc:
  enabled: true
  chains:
    - name: "L2-base-sepolia"
      network_id: "84532"
      kind: "opstack"
      network: "base-sepolia"
      execution_rpc: "https://sepolia.base.org"
      local_rpc_port: 18545
    - name: "ethereum-mainnet"
      network_id: "1"
      kind: "ethereum"
      network: "mainnet"
      # NOTE: Replace with your own mainnet execution RPC.
      execution_rpc: "https://eth-mainnet.g.alchemy.com/v2/YOUR_API_KEY"
      local_rpc_port: 18546

# Resource defaults
defaults:
  cpu_count: 2
  memory_mb: 2048
